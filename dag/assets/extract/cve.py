import ibis
import dagster

from dag import functions as f


@dagster.asset(deps=["extract_categories"])
def extract_vulnerabilities():
    """
    Extract the ingested cve vulnerabilities data.
    """
    vulnerabilities = f.clean_data(ibis.read_json("data/ingest/nvd/cve_*.*.json"))
    return vulnerabilities
