from dataclasses import dataclass
from datetime import datetime

@dataclass
class CveRequestParams:
    pub_start_date: datetime
    pub_end_date: datetime
    severity_key: str
    severity_value: str

    def params_as_dict(self):
        return { "pubStartDate": self.pub_start_date.isoformat(), 
                "pubEndDate": self.pub_end_date.isoformat(), 
                self.severity_key: self.severity_value }
    
    def __str__(self):
        return f'start_{self.pub_start_date.strftime("%y_%m_%d")}_end_{self.pub_end_date.strftime("%y_%m_%d")}_{self.severity_key}_{self.severity_value}'
